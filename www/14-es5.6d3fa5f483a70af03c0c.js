(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{qqR4:function(l,n,e){"use strict";e.r(n);var t=e("8Y7J"),u=e("mrSG"),o=e("r28Q"),i=e("ZZ/e"),s=e("gTw3"),a=e("23JA"),r=e("joI2");class d{constructor(l,n,e,t,u,o,i,s,a){this.route=l,this.server=n,this.toastController=e,this.nav=t,this.loadingController=u,this.geolocation=o,this.nativeGeocoder=i,this.renderer=s,this._document=a,this.apiKey="AIzaSyCeHcSHzfqisO8Si_FW4s-EzyK9wJTsJ2U",this.text=JSON.parse(localStorage.getItem("app_text"))}ngOnInit(){this.injectSDK().then(l=>{this.loadMap()})}injectSDK(){return new Promise((l,n)=>{window.mapInit=()=>{l(!0)};let e=this.renderer.createElement("script");e.id="googleMaps",e.src=this.apiKey?"https://maps.googleapis.com/maps/api/js?key="+this.apiKey+"&callback=mapInit":"https://maps.googleapis.com/maps/api/js?callback=mapInit",this.renderer.appendChild(this._document.body,e)})}loadMap(){return u.__awaiter(this,void 0,void 0,(function*(){this.geolocation.getCurrentPosition().then(l=>{let n={center:new google.maps.LatLng(l.coords.latitude,l.coords.longitude),zoom:15,disableDefaultUI:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:r.a};this.getAddressFromCoords(l.coords.latitude,l.coords.longitude),this.map=new google.maps.Map(this.mapElement.nativeElement,n),this.map.addListener("tilesloaded",()=>{this.getAddressFromCoords(this.map.center.lat(),this.map.center.lng())})}).catch(l=>{console.log("Error al obtener la ubicaci\xf3n",l)})}))}getAddressFromCoords(l,n){return u.__awaiter(this,void 0,void 0,(function*(){var e=new google.maps.Geocoder;let t=this;this.nativeGeocoder.reverseGeocode(l,n,{useLocale:!0,maxResults:5}).then(l=>{this.address="";let n=[];for(let[e,t]of Object.entries(l[0]))t.length>0&&n.push(t);n.reverse();for(let e of n)this.address+=e+", ";this.address=this.address.slice(0,-2)}).catch(u=>{document.getElementById("addressPWA");var o={lat:parseFloat(l),lng:parseFloat(n)};let i=[];e.geocode({location:o},(function(l,n){if("OK"===n){t.address="";for(let[n,e]of Object.entries(l[0]))i.push(e);i.reverse();for(let l of i)t.address+=l+", ";t.address=i[4]}else console.log("Geocoder failed due to: "+n)}))})}))}saveAddress(l){return u.__awaiter(this,void 0,void 0,(function*(){const n=yield this.loadingController.create({message:"Porfavor espere..."});yield n.present();var e={address:l.address,lat:this.map.center.lat(),lng:this.map.center.lng(),user_id:localStorage.getItem("user_id")};this.server.saveAddress(e).subscribe(e=>{localStorage.setItem("address",l.address),this.nav.back(),this.presentToast("Direcci\xf3n guardada con \xe9xito."),n.dismiss()})}))}presentToast(l){return u.__awaiter(this,void 0,void 0,(function*(){(yield this.toastController.create({message:l,duration:3e3,position:"top",mode:"ios",color:"dark"})).present()}))}}class b{}var c=e("pMnS"),p=e("oBZk"),g=e("s7LF"),m=e("iInd"),h=e("SVse"),C=t.Bb({encapsulation:0,styles:[["#map_canvas[_ngcontent-%COMP%]{width:90%;height:60%;border:1px solid red}#address[_ngcontent-%COMP%]{padding:0;font-size:18px;font-weight:700}.map-wrapper[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.map-wrapper[_ngcontent-%COMP%]   #map_center[_ngcontent-%COMP%]{position:absolute;z-index:99;height:40px;width:40px;top:50%;left:50%;margin-left:-21px;margin-top:-41px}.map-wrapper[_ngcontent-%COMP%]   #map[_ngcontent-%COMP%]{width:100%;height:100%}"]],data:{}});function v(l){return t.Zb(0,[t.Vb(671088640,1,{mapElement:0}),(l()(),t.Db(1,0,null,null,17,"ion-header",[],null,null,null,p.vb,p.t)),t.Cb(2,49152,null,0,i.F,[t.j,t.p,t.F],null,null),(l()(),t.Db(3,0,null,0,15,"ion-toolbar",[["color","primary"]],null,null,null,p.dc,p.bb)),t.Cb(4,49152,null,0,i.Gb,[t.j,t.p,t.F],{color:[0,"color"]},null),(l()(),t.Db(5,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,p.ib,p.g)),t.Cb(6,49152,null,0,i.p,[t.j,t.p,t.F],null,null),(l()(),t.Db(7,0,null,0,2,"ion-back-button",[],null,[[null,"click"]],(function(l,n,e){var u=!0;return"click"===n&&(u=!1!==t.Pb(l,9).onClick(e)&&u),u}),p.eb,p.c)),t.Cb(8,49152,null,0,i.k,[t.j,t.p,t.F],null,null),t.Cb(9,16384,null,0,i.l,[[2,i.mb],i.Nb],null,null),(l()(),t.Db(10,0,null,0,6,"ion-buttons",[["slot","end"]],null,null,null,p.ib,p.g)),t.Cb(11,49152,null,0,i.p,[t.j,t.p,t.F],null,null),(l()(),t.Db(12,0,null,0,4,"ion-button",[["fill","outline"],["shape","round"],["style","font-size: 12px"]],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.loadMap()&&t),t}),p.hb,p.f)),t.Cb(13,49152,null,0,i.o,[t.j,t.p,t.F],{fill:[0,"fill"],shape:[1,"shape"]},null),(l()(),t.Db(14,0,null,0,1,"ion-icon",[["name","locate"],["slot","start"]],null,null,null,p.wb,p.u)),t.Cb(15,49152,null,0,i.G,[t.j,t.p,t.F],{name:[0,"name"]},null),(l()(),t.Xb(-1,0,[" Mi ubicaci\xf3n "])),(l()(),t.Db(17,0,null,0,1,"ion-title",[],null,null,null,p.cc,p.ab)),t.Cb(18,49152,null,0,i.Eb,[t.j,t.p,t.F],null,null),(l()(),t.Db(19,0,null,null,5,"ion-content",[],null,null,null,p.qb,p.o)),t.Cb(20,49152,null,0,i.y,[t.j,t.p,t.F],null,null),(l()(),t.Db(21,0,null,0,3,"div",[["class","map-wrapper"]],null,null,null,null,null)),(l()(),t.Db(22,0,null,null,1,"div",[["id","map_center"]],null,null,null,null,null)),(l()(),t.Db(23,0,null,null,0,"img",[["src","assets/map-marker.png"],["width","30px"]],null,null,null,null,null)),(l()(),t.Db(24,0,[[1,0],["map",1]],null,0,"div",[["id","map"]],null,null,null,null,null)),(l()(),t.Db(25,0,null,null,25,"ion-footer",[],null,null,null,p.tb,p.r)),t.Cb(26,49152,null,0,i.D,[t.j,t.p,t.F],null,null),(l()(),t.Db(27,0,null,0,23,"div",[["id","address"]],null,null,null,null,null)),(l()(),t.Db(28,0,null,null,22,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],(function(l,n,e){var u=!0,o=l.component;return"submit"===n&&(u=!1!==t.Pb(l,30).onSubmit(e)&&u),"reset"===n&&(u=!1!==t.Pb(l,30).onReset()&&u),"ngSubmit"===n&&(u=!1!==o.saveAddress(t.Pb(l,30).value)&&u),u}),null,null)),t.Cb(29,16384,null,0,g.o,[],null,null),t.Cb(30,4210688,[["form",4]],0,g.i,[[8,null],[8,null]],null,{ngSubmit:"ngSubmit"}),t.Ub(2048,null,g.a,null,[g.i]),t.Cb(32,16384,null,0,g.h,[[4,g.a]],null,null),(l()(),t.Db(33,0,null,null,13,"ion-item",[],null,null,null,p.Db,p.y)),t.Cb(34,49152,null,0,i.L,[t.j,t.p,t.F],null,null),(l()(),t.Db(35,0,null,0,2,"ion-label",[["position","floating"]],null,null,null,p.Eb,p.C)),t.Cb(36,49152,null,0,i.R,[t.j,t.p,t.F],{position:[0,"position"]},null),(l()(),t.Xb(37,0,["",""])),(l()(),t.Db(38,0,null,0,8,"ion-textarea",[["name","address"],["required",""]],[[1,"required",0],[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(l,n,e){var u=!0,o=l.component;return"ionBlur"===n&&(u=!1!==t.Pb(l,41)._handleBlurEvent(e.target)&&u),"ionChange"===n&&(u=!1!==t.Pb(l,41)._handleInputEvent(e.target)&&u),"ngModelChange"===n&&(u=!1!==(o.address=e)&&u),u}),p.ac,p.Y)),t.Cb(39,16384,null,0,g.l,[],{required:[0,"required"]},null),t.Ub(1024,null,g.d,(function(l){return[l]}),[g.l]),t.Cb(41,16384,null,0,i.Vb,[t.p],null,null),t.Ub(1024,null,g.e,(function(l){return[l]}),[i.Vb]),t.Cb(43,671744,null,0,g.j,[[2,g.a],[6,g.d],[8,null],[6,g.e]],{name:[0,"name"],model:[1,"model"]},{update:"ngModelChange"}),t.Ub(2048,null,g.f,null,[g.j]),t.Cb(45,16384,null,0,g.g,[[4,g.f]],null,null),t.Cb(46,49152,null,0,i.Cb,[t.j,t.p,t.F],{name:[0,"name"],required:[1,"required"]},null),(l()(),t.Db(47,0,null,null,3,"div",[["class","ion-padding"]],null,null,null,null,null)),(l()(),t.Db(48,0,null,null,2,"ion-button",[["expand","block"],["mode","ios"],["type","submit"]],null,null,null,p.hb,p.f)),t.Cb(49,49152,null,0,i.o,[t.j,t.p,t.F],{disabled:[0,"disabled"],expand:[1,"expand"],mode:[2,"mode"],type:[3,"type"]},null),(l()(),t.Xb(-1,0,["Agregar direcci\xf3n"]))],(function(l,n){var e=n.component;l(n,4,0,"primary"),l(n,13,0,"outline","round"),l(n,15,0,"locate"),l(n,36,0,"floating"),l(n,39,0,""),l(n,43,0,"address",e.address),l(n,46,0,"address",""),l(n,49,0,!t.Pb(n,30).valid,"block","ios","submit")}),(function(l,n){var e=n.component;l(n,28,0,t.Pb(n,32).ngClassUntouched,t.Pb(n,32).ngClassTouched,t.Pb(n,32).ngClassPristine,t.Pb(n,32).ngClassDirty,t.Pb(n,32).ngClassValid,t.Pb(n,32).ngClassInvalid,t.Pb(n,32).ngClassPending),l(n,37,0,e.text.add_address),l(n,38,0,t.Pb(n,39).required?"":null,t.Pb(n,45).ngClassUntouched,t.Pb(n,45).ngClassTouched,t.Pb(n,45).ngClassPristine,t.Pb(n,45).ngClassDirty,t.Pb(n,45).ngClassValid,t.Pb(n,45).ngClassInvalid,t.Pb(n,45).ngClassPending)}))}var f=t.zb("app-address",d,(function(l){return t.Zb(0,[(l()(),t.Db(0,0,null,null,1,"app-address",[],null,null,null,v,C)),t.Cb(1,114688,null,0,d,[m.a,o.a,i.Wb,i.Nb,i.Kb,s.a,a.a,t.L,h.d],null,null)],(function(l,n){l(n,1,0)}),null)}),{},{},[]);e.d(n,"AddressPageModuleNgFactory",(function(){return P}));var P=t.Ab(b,[],(function(l){return t.Mb([t.Nb(512,t.m,t.lb,[[8,[c.a,f]],[3,t.m],t.D]),t.Nb(4608,h.l,h.k,[t.z,[2,h.t]]),t.Nb(4608,g.n,g.n,[]),t.Nb(4608,i.c,i.c,[t.F,t.g]),t.Nb(4608,i.Mb,i.Mb,[i.c,t.m,t.w]),t.Nb(4608,i.Rb,i.Rb,[i.c,t.m,t.w]),t.Nb(1073742336,h.b,h.b,[]),t.Nb(1073742336,g.m,g.m,[]),t.Nb(1073742336,g.b,g.b,[]),t.Nb(1073742336,i.Ib,i.Ib,[]),t.Nb(1073742336,m.p,m.p,[[2,m.u],[2,m.m]]),t.Nb(1073742336,b,b,[]),t.Nb(1024,m.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);